# Оптимизация развертывания on-site среды Creatio

### Приветствую тебя! Ты, как и я, много времени тратишь на развертывание среды в IIS? Тогда это для тебя :relaxed: Я работаю над скриптом, который позволит сократить времяпрепровождение за подобным занятием. 
____
## Что сможет делать такой скрипт?
Выделено то, что уже реализовано. Остальное будет в ближайшее время реализовано :wink:
+ `Копирует среды.`
+ `Добавляет сайты в IIS.`
+ Меняет содержимое файлов в файловой системе
    + `Меняет файл Web.config для среды разработки.`
    + Меняет файл ConnectionString.config.
+ Восстанавливает базу данных
    + Восстановление из .bak файла базы данных в MS SQL.
    + Восстановление из .backup файла базы данных в Postgre.
____
## Конфигурация системы
:arrow_forward:Прежде чем запустить у себя, необходимо в powershell разрешить запуск скриптов. Для этого в Powershell введите:

```powershell
    Set-ExecutionPolicy Unrestricted CurrentUser -Force
```
:arrow_forward:Сам скрипт следует расположить в одной директории с папкой чистой среды.    
:arrow_forward:Запустить скрипт от имени администратора.    
____
## Структура скрипта
Скрипт имеет структуру, которая описана комментариями в скрипте:pencil2:
+ Основные настройки
+ Дополнительные настройки
+ Функции с реализованной логикой
+ Начало работы программы

:speech_balloon: Чтобы всё работало, достаточно менять только основные настройки!
## А как этот ваш скрипт настроить? Сейчас расскажу!
:one: Первым делом идёт путь размещения среды. Это путь, куда при копировании будут попадать все ваши среды
```powershell
    #Путь размещения среды
    $PathEnviroument = "C:\inetpub\wwwroot"
```
:two: Вторым идёт название вашего проекта.  
:heavy_exclamation_mark: **С таким названием должна быть папка вашей чистой среды.** :heavy_exclamation_mark:   
Такое основное название будет и у новоскопированных сред.
```powershell
    #Название папки с проектом
    $NameEnvironment = "NTL"
```
:three: Третьим пунктом идёт конфигурация сред.   
:heavy_exclamation_mark: **Важно, чтобы было указано минимум 2 среды для корректной работы скрипта**. :heavy_exclamation_mark:    
Если требуется сделать только одну среду, то сделайте `$Envirouments[1] = $false`. В данном случае, здесь указано 3 среды. Вы можете через запятую указать столько сред, сколько хотите получить! :grinning:
### Аргументы двумерного массива с конфигурацией среды
+ 0 аргумент: *Текст приписки среды.*    
Если `$NameEnvironment = "NTL"`, а `$Envirouments[0] = '_dev'`, то получится название папки новой среды: `NTL_dev`
+ 1 аргумент: *Необходимость копирования.*    
Если `$Envirouments[1] = $true` и папки с таким названием нет, то это среда будет скопирована. Если такая папка есть, то консоль уведомит вас о наличии такой папки.     
Если `$Envirouments[1] = $false`, то папка не будет копироваться
+ 2 аргумент: *Необходимость изменения файла web.config*    
Если `$Envirouments[2] = $true`, то в файле Web.config поменяются параметры, необходимые для разработки в файловой системе.    
Если `$Envirouments[2] = $false`, то файл не изменится.
+ 3 аргумент: *Название сайта в IIS.*    
Можете указать то имя, которое хотите видеть в названии IIS. Не хотите заморачиваться? Тогда просто укажите в аргументе значение `defaultName`!
+ 4 аргумент: *Номер порта в IIS.*    
По аналогии можете указать нужный порт сайта. Не хотите заморачиваться? Тогда просто укажите в аргументе значение `defaultPort`! 
```powershell
    #Двумерный массив с конфигурацией среды.
    $Envirouments = @(
        @('_dev',     $true,  $true,   'defaultName', 'defaultPort'),
        @('_test',    $true,  $false,  'Site_test',   'defaultPort'),
        @('_test2',  $true,  $false,  'defaultName',    '4015')
    )
```
